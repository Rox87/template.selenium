/*!
 * 
 *     MCAFEE RESTRICTED CONFIDENTIAL
 *     Copyright (c) 2023 McAfee, LLC
 *
 *     The source code contained or described herein and all documents related
 *     to the source code ("Material") are owned by McAfee or its
 *     suppliers or licensors. Title to the Material remains with McAfee
 *     or its suppliers and licensors. The Material contains trade
 *     secrets and proprietary and confidential information of McAfee or its
 *     suppliers and licensors. The Material is protected by worldwide copyright
 *     and trade secret laws and treaty provisions. No part of the Material may
 *     be used, copied, reproduced, modified, published, uploaded, posted,
 *     transmitted, distributed, or disclosed in any way without McAfee's prior
 *     express written permission.
 *
 *     No license under any patent, copyright, trade secret or other intellectual
 *     property right is granted to or conferred upon you by disclosure or
 *     delivery of the Materials, either expressly, by implication, inducement,
 *     estoppel or otherwise. Any license under such intellectual property rights
 *     must be expressed and approved by McAfee in writing.
 *
 */(()=>{"use strict";const e=0,t=0,o=1,n=2,i=3,s=4,r=1,c=2,a=3,l=4,d={BACKGROUND:"BACKGROUND",CONTENT:"CONTENT",TELEMETRY:"TELEMETRY"},u={DEFAULT:"color: #000000; font-weight: normal; font-style:normal; background: #FFFFFF;",BACKGROUND:"color: #8D0DBA; font-weight: bold; background: #FFFFFF;",CONTENT:"color: #F54A26; font-weight: bold; background: #FFFFFF;",TELEMETRY:"color: #147831; font-weight: bold; background: #FFFFFF;"};class h{static log(e,t=null){f(e,r,t)}static error(e,t=null){f(e,c,t)}static warn(e,t=null){f(e,a,t)}static debug(e,t=null){f(e,l,t)}}const f=(h,f,m)=>{const F=e;if(F===t)return;let g="chrome-extension:"===location.protocol?d.BACKGROUND:d.CONTENT;m&&d[m]&&(g=m);const b=new Date,N=f===c?h:`%c[${g} ${b.toLocaleString([],{hour:"2-digit",minute:"2-digit",hour12:!0})}]: %c${h}`,p=u.DEFAULT;let E=u[g];if(E||(E=p),F>=n&&f===c&&console.error(h),F>=o&&f===r&&console.log(N,E,p),F>=i&&f===a){const e="color: #FFA500; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cWARN - ${N}`,e,E,p)}if(F>=s&&f===l){const e="color: #FF33D7; font-family: sans-serif; font-weight: bolder; text-shadow: #000 1px 1px;";console.log(`%cDEBUG - ${N}`,e,E,p)}};class m{constructor(e){this.pingCommand=e,this.basePingListener()}basePingListener(e=null){((e,t=null,o)=>{"function"==typeof o?chrome.runtime.onMessage.addListener(((n,i,s)=>{if(i.id===chrome.runtime.id&&"object"==typeof n&&!Array.isArray(n)&&n?.ipcId===e)return o({promises:t,request:n,sender:i,sendResponse:s})})):h.error("Provided with invalid callback function")})("WA",null,(({request:t,sendResponse:o})=>{const{command:n}=t;if(n===this.pingCommand)return h.debug(`File Injection [pinged]: Received ${n} command`),o({content:!0}),"function"==typeof e&&e(),!0}))}}class F{constructor(){this.observer=null,this.clientNotified=!1,this.autoplayDetectedFn=null}_recursiveProcess(e){for(let t=0;t<e.childNodes.length;++t){if(this.clientNotified)return;this._recursiveProcess(e.childNodes[t])}if(e instanceof HTMLMediaElement){if(this.clientNotified)return;e.autoplay&&(this.clientNotified=!0,this.autoplayDetectedFn(e))}}init(e){this.autoplayDetectedFn=e,this.observer=new MutationObserver(this.handleMutations.bind(this)),this.observer.observe(document,{childList:!0,subtree:!0});const t=document.querySelectorAll("audio, video");for(let e=0;e<t.length&&!this.clientNotified;++e)t[e].autoplay&&(this.clientNotified=!0,this.autoplayDetectedFn(t[e]))}handleMutations(e){e.forEach((e=>{for(const t of e.addedNodes)this._recursiveProcess(t),this.clientNotified&&this.observer.disconnect()}))}}const g="AUTO_RUN_VIDEO_SITE",b="PING_CONTENT_AUTOPLAY_DETECTION",N=(e,t,o,n,i=null)=>{if(!chrome.tabs)throw new Error('"tabs" permission not set in manifest.');return chrome.tabs.sendMessage(n,{ipcId:e,command:t,...o},{frameId:i})},p=(e,t={},o)=>(async(e,t,o={},n={})=>{try{if(n?.tabId){const{tabId:i,frameId:s}=n;return await N(e,t,o,i,s)}if(n?.broadcast){const i=await chrome.tabs.query({}),{broadcastIgnoreId:s=[]}=n;return i.filter((({id:e})=>!s.includes(e))).forEach((({id:n})=>{N(e,t,o,n)})),!0}return await chrome.runtime.sendMessage({ipcId:e,command:t,...o})}catch(e){return h.warn(`Unexpected error when calling command: "${t}", err: ${e.message}`),null}})("WA",e,t,o);(new class extends m{constructor(){super(b)}autoRunVideo(e){p(g,{url:e})}main(){(new F).init((e=>this.autoRunVideo(e)))}}).main()})();
//# sourceMappingURL=../sourceMap/chrome/scripts/content_autoplay_detection.js.map